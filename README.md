# –ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ positive-support-test

Telegram –±–æ—Ç –¥–ª—è –≤–∑–∞–∏–º–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ –ø–æ–º–æ—â–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–µ–ø–ª–æ–µ–º —á–µ—Ä–µ–∑ GitHub Actions.

## üöÄ CI/CD –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–µ–ø–ª–æ–π

### ‚ö†Ô∏è –í–∞–∂–Ω–æ: –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–±–∏–≤–∞–µ—Ç –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è workflow. –î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **systemd —Å–µ—Ä–≤–∏—Å—ã**.

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
- Workflow —Å–æ–∑–¥–∞–µ—Ç systemd —Å–µ—Ä–≤–∏—Å—ã –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- –°–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç GitHub Actions
- –ü—Ä–æ—Ü–µ—Å—Å—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ø–ª–æ—è

**–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** [SYSTEMD_SETUP.md](SYSTEMD_SETUP.md)

### –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è
```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º CI/CD –∑–∞ 5 –º–∏–Ω—É—Ç
git clone https://github.com/YOUR_USERNAME/positive-support-test.git
cd positive-support-test
chmod +x *.sh
sudo ./setup-github-runner.sh YOUR_USERNAME REPO_NAME RUNNER_TOKEN
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é:**
- üìö [–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](DEPLOYMENT_GUIDE.md) - –ø–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD
- ‚ö° [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](QUICK_START.md) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞ 5 –º–∏–Ω—É—Ç
- üîê [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets](#github-secrets)

### –§–∞–π–ª—ã CI/CD —Å–∏—Å—Ç–µ–º—ã
- `.github/workflows/dev-deploy.yml` - GitHub Actions workflow
- `setup-github-runner.sh` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ self-hosted runner
- `deploy.sh` - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è  
- `setup-services.sh` - —Å–æ–∑–¥–∞–Ω–∏–µ systemd —Å–µ—Ä–≤–∏—Å–æ–≤
- `manage-services.sh` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏

## üîß –ê–¥–º–∏–Ω-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∞–¥–º–∏–Ω-–±–æ—Ç–∞ –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**
1. –°–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω-–±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather)
2. –î–æ–±–∞–≤—å—Ç–µ `ADMIN_BOT_TOKEN` –∏ `ADMIN_ID` –≤ —Ñ–∞–π–ª `.env`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `start_admin.bat` (Windows) –∏–ª–∏ `./start_admin.sh` (Linux)

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [ADMIN_BOT_GUIDE.md](ADMIN_BOT_GUIDE.md)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –Ω–∏–∫–Ω–µ–π–º—É
- üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∂–∞–ª–æ–± –∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- ‚úÖ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è

## üìã –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PostgreSQL
- –°–∫–∞—á–∞—Ç—å: https://www.postgresql.org/download/
- –ó–∞–ø–æ–º–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `postgres`

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
```bash
python setup_db_manual.py
```
(–ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ–º–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –≤ —Ñ–∞–π–ª–µ!)

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å
```bash
run.bat
```

## –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

- `bot.py` - Telegram –±–æ—Ç
- `main.py` - API —Å–µ—Ä–≤–µ—Ä
- `setup_db_manual.py` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `clear_bot.py` - –æ—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –±–æ—Ç–∞
- `requirements.txt` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
- `run.bat` - –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

- API: http://localhost:8000/health
- –ë–æ—Ç: –Ω–∞–π—Ç–∏ –≤ Telegram –∏ –Ω–∞–ø–∏—Å–∞—Ç—å `/start`

## –§—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞

- üíå –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É
- üî• –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É  
- üÜò –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å
- ü§ù –ü–æ–º–æ—á—å –∫–æ–º—É-–Ω–∏–±—É–¥—å
- üë§ –ü—Ä–æ—Ñ–∏–ª—å - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## –°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
python check_db.py
```
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ.

### –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
```bash
python backup_db.py
```
–°–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª `backup_YYYYMMDD_HHMMSS.json`.

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
python backup_db.py restore backup_file.json
```

## –§–∞–π–ª—ã –±—ç–∫–∞–ø–∞

- `bot_backup_full_profile.py` - –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–æ—Ç–∞ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π —Å–º–µ–Ω—ã –Ω–∏–∫–Ω–µ–π–º–∞
- `bot.py` - —Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è (–ø—Ä–æ—Ñ–∏–ª—å –±–µ–∑ —Å–º–µ–Ω—ã –Ω–∏–∫–Ω–µ–π–º–∞)

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –≤–µ—Ä—Å–∏–∏:
```bash
copy bot_backup_full_profile.py bot.py
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
- PostgreSQL —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–∏—Å–∫–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–∫–æ–º–º–∏—Ç –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

## üîê GitHub Secrets

–î–ª—è —Ä–∞–±–æ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (`Settings` ‚Üí `Secrets and variables` ‚Üí `Actions`):

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
| –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|----------|---------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | `123456:ABC-DEF...` |
| `DB_PASSWORD` | –ü–∞—Ä–æ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `secure_password` |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
| –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| `DB_HOST` | –•–æ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `localhost` |
| `DB_USER` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î | `postgres` |
| `DB_NAME` | –ù–∞–∑–≤–∞–Ω–∏–µ –ë–î | `support_bot` |
| `BACKEND_URL` | URL API | `http://localhost:8000` |

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏:
```bash
./manage-services.sh start    # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./manage-services.sh stop     # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./manage-services.sh restart  # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./manage-services.sh status   # –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./manage-services.sh logs     # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```

### –ö–æ–º–∞–Ω–¥—ã –¥–µ–ø–ª–æ—è:
```bash
./deploy.sh          # –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π
./deploy.sh status   # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
./deploy.sh stop     # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
./deploy.sh restart  # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API
curl http://localhost:8000/health

# –°—Ç–∞—Ç—É—Å systemd —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl status positive-support-api
sudo systemctl status positive-support-bot

# –õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
sudo journalctl -u positive-support-api -f
sudo journalctl -u positive-support-bot -f
```

## üîÑ Workflow –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

1. **Push –≤ –≤–µ—Ç–∫—É `dev`** ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π trigger GitHub Actions
2. **GitHub Actions** ‚Üí –ó–∞–ø—É—Å–∫ workflow –Ω–∞ self-hosted runner
3. **Self-hosted runner** ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–ø–ª–æ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
   - –ó–∞–ø—É—Å–∫ –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
   - Health check –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

**–í—Ä–µ–º—è –¥–µ–ø–ª–æ—è:** ~2-3 –º–∏–Ω—É—Ç—ã  
**Downtime:** ~10-15 —Å–µ–∫—É–Ω–¥ (–≤—Ä–µ–º—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤)